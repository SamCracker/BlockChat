{"ast":null,"code":"var crypto = require('crypto');\n\nvar wallet = require('ethereumjs-wallet');\n\nvar algorithm = require('aes256');\n\nmodule.exports.getEncryptAlgorithm = function () {\n  return algorithm;\n};\n\nmodule.exports.getEncryptAlgorithmInHex = function () {\n  return '0x' + Buffer.from(algorithm, 'ascii').toString('hex');\n};\n\nmodule.exports.hexStringToAsciiString = function (hexString) {\n  if (hexString.startsWith('0x')) {\n    hexString = hexString.substr(2);\n  }\n\n  return Buffer.from(hexString, 'hex').toString('ascii').replace(/\\0/g, '');\n};\n\nmodule.exports.privateToPublic = function (privateKey) {\n  var account = crypto.createECDH('secp256k1');\n  account.setPrivateKey(privateKey);\n  return account.getPublicKey().slice(1);\n};\n\nmodule.exports.computeSecret = function (privateKeyFromA, publicKeyFromB) {\n  var A = crypto.createECDH('secp256k1');\n  A.setPrivateKey(privateKeyFromA);\n  return A.computeSecret(publicKeyFromB);\n};\n\nexports.encrypt = function (message, secret) {\n  var cipher = crypto.createCipher(algorithm, secret);\n  var crypted = cipher.update(message, 'utf8', 'hex');\n  crypted += cipher[\"final\"]('hex');\n  return crypted;\n};\n\nexports.decrypt = function (encryptedMessage, secret) {\n  var decipher = crypto.createDecipher(algorithm, secret);\n  var dec = decipher.update(encryptedMessage, 'hex', 'utf8');\n  dec += decipher[\"final\"]('utf8');\n  return dec;\n}; // exports.getPubkeyFromTransaction = (rawTx) => {\n//       var localTx = {\n//         nonce: parseInt(rawTx.nonce),\n//         gasPrice: parseInt(rawTx.gasPrice),\n//         gasLimit: parseInt(rawTx.gas),\n//         to: rawTx.to,\n//         value: parseInt(rawTx.value),\n//         r: rawTx.r,\n//         s: rawTx.s,\n//         v: rawTx.v,\n//         data: rawTx.input,\n//       };\n//     var txInstance = new Transaction(localTx);\n//     return txInstance.getSenderPublicKey().toString('hex');\n//   }","map":{"version":3,"sources":["D:/BlockChat/BlockChat/support/Utils.js"],"names":["crypto","require","wallet","algorithm","module","exports","getEncryptAlgorithm","getEncryptAlgorithmInHex","Buffer","from","toString","hexStringToAsciiString","hexString","startsWith","substr","replace","privateToPublic","privateKey","account","createECDH","setPrivateKey","getPublicKey","slice","computeSecret","privateKeyFromA","publicKeyFromB","A","encrypt","message","secret","cipher","createCipher","crypted","update","decrypt","encryptedMessage","decipher","createDecipher","dec"],"mappings":"AAAA,IAAIA,MAAM,GAAGC,OAAO,CAAC,QAAD,CAApB;;AACA,IAAIC,MAAM,GAAGD,OAAO,CAAC,mBAAD,CAApB;;AAEA,IAAIE,SAAS,GAAGF,OAAO,CAAC,QAAD,CAAvB;;AAEAG,MAAM,CAACC,OAAP,CAAeC,mBAAf,GAAqC,YAAM;AACvC,SAAOH,SAAP;AACH,CAFD;;AAIAC,MAAM,CAACC,OAAP,CAAeE,wBAAf,GAA0C,YAAM;AAC5C,SAAO,OAAOC,MAAM,CAACC,IAAP,CAAYN,SAAZ,EAAuB,OAAvB,EAAgCO,QAAhC,CAAyC,KAAzC,CAAd;AACH,CAFD;;AAIAN,MAAM,CAACC,OAAP,CAAeM,sBAAf,GAAwC,UAACC,SAAD,EAAe;AACnD,MAAIA,SAAS,CAACC,UAAV,CAAqB,IAArB,CAAJ,EAAgC;AAC5BD,IAAAA,SAAS,GAAGA,SAAS,CAACE,MAAV,CAAiB,CAAjB,CAAZ;AACH;;AACD,SAAON,MAAM,CAACC,IAAP,CAAYG,SAAZ,EAAuB,KAAvB,EAA8BF,QAA9B,CAAuC,OAAvC,EAAgDK,OAAhD,CAAwD,KAAxD,EAA+D,EAA/D,CAAP;AACH,CALD;;AAOAX,MAAM,CAACC,OAAP,CAAeW,eAAf,GAAiC,UAACC,UAAD,EAAgB;AAC7C,MAAIC,OAAO,GAAGlB,MAAM,CAACmB,UAAP,CAAkB,WAAlB,CAAd;AACAD,EAAAA,OAAO,CAACE,aAAR,CAAsBH,UAAtB;AACA,SAAOC,OAAO,CAACG,YAAR,GAAuBC,KAAvB,CAA6B,CAA7B,CAAP;AACH,CAJD;;AAMAlB,MAAM,CAACC,OAAP,CAAekB,aAAf,GAA+B,UAACC,eAAD,EAAkBC,cAAlB,EAAqC;AAChE,MAAIC,CAAC,GAAG1B,MAAM,CAACmB,UAAP,CAAkB,WAAlB,CAAR;AACAO,EAAAA,CAAC,CAACN,aAAF,CAAgBI,eAAhB;AACA,SAAOE,CAAC,CAACH,aAAF,CAAgBE,cAAhB,CAAP;AACH,CAJD;;AAMApB,OAAO,CAACsB,OAAR,GAAkB,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACnC,MAAIC,MAAM,GAAG9B,MAAM,CAAC+B,YAAP,CAAoB5B,SAApB,EAA+B0B,MAA/B,CAAb;AACA,MAAIG,OAAO,GAAGF,MAAM,CAACG,MAAP,CAAcL,OAAd,EAAsB,MAAtB,EAA6B,KAA7B,CAAd;AACAI,EAAAA,OAAO,IAAIF,MAAM,SAAN,CAAa,KAAb,CAAX;AACA,SAAOE,OAAP;AACD,CALH;;AAOA3B,OAAO,CAAC6B,OAAR,GAAkB,UAACC,gBAAD,EAAmBN,MAAnB,EAA8B;AAC5C,MAAIO,QAAQ,GAAGpC,MAAM,CAACqC,cAAP,CAAsBlC,SAAtB,EAAgC0B,MAAhC,CAAf;AACA,MAAIS,GAAG,GAAGF,QAAQ,CAACH,MAAT,CAAgBE,gBAAhB,EAAiC,KAAjC,EAAuC,MAAvC,CAAV;AACAG,EAAAA,GAAG,IAAIF,QAAQ,SAAR,CAAe,MAAf,CAAP;AACA,SAAOE,GAAP;AACH,CALD,C,CAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA","sourcesContent":["var crypto = require('crypto');\r\nvar wallet = require('ethereumjs-wallet');\r\n\r\nvar algorithm = require('aes256');\r\n\r\nmodule.exports.getEncryptAlgorithm = () => {\r\n    return algorithm;\r\n}\r\n\r\nmodule.exports.getEncryptAlgorithmInHex = () => {\r\n    return '0x' + Buffer.from(algorithm, 'ascii').toString('hex');\r\n}\r\n\r\nmodule.exports.hexStringToAsciiString = (hexString) => {\r\n    if (hexString.startsWith('0x')) {\r\n        hexString = hexString.substr(2);\r\n    }\r\n    return Buffer.from(hexString, 'hex').toString('ascii').replace(/\\0/g, '');\r\n}\r\n\r\nmodule.exports.privateToPublic = (privateKey) => {\r\n    var account = crypto.createECDH('secp256k1');\r\n    account.setPrivateKey(privateKey);\r\n    return account.getPublicKey().slice(1);\r\n}\r\n\r\nmodule.exports.computeSecret = (privateKeyFromA, publicKeyFromB) => {\r\n    var A = crypto.createECDH('secp256k1');\r\n    A.setPrivateKey(privateKeyFromA);\r\n    return A.computeSecret(publicKeyFromB);\r\n}\r\n\r\nexports.encrypt = (message, secret) => {\r\n    var cipher = crypto.createCipher(algorithm, secret);\r\n    var crypted = cipher.update(message,'utf8','hex')\r\n    crypted += cipher.final('hex');\r\n    return crypted;\r\n  }\r\n  \r\nexports.decrypt = (encryptedMessage, secret) => {\r\n    var decipher = crypto.createDecipher(algorithm,secret)\r\n    var dec = decipher.update(encryptedMessage,'hex','utf8')\r\n    dec += decipher.final('utf8');\r\n    return dec;\r\n}\r\n\r\n// exports.getPubkeyFromTransaction = (rawTx) => {\r\n//       var localTx = {\r\n//         nonce: parseInt(rawTx.nonce),\r\n//         gasPrice: parseInt(rawTx.gasPrice),\r\n//         gasLimit: parseInt(rawTx.gas),\r\n//         to: rawTx.to,\r\n//         value: parseInt(rawTx.value),\r\n//         r: rawTx.r,\r\n//         s: rawTx.s,\r\n//         v: rawTx.v,\r\n//         data: rawTx.input,\r\n//       };\r\n  \r\n//     var txInstance = new Transaction(localTx);\r\n//     return txInstance.getSenderPublicKey().toString('hex');\r\n//   }"]},"metadata":{},"sourceType":"script"}